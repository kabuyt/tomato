<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>„Éà„Éû„Éà N5 - Pro</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; text-align: center; background: #FFF9E6; color: #333; margin: 0; padding: 0; }
        .page { display: none; padding: 20px; min-height: 100vh; box-sizing: border-box; }
        .active { display: block; }

        /* „É°„Éã„É•„Éº */
        .logo { font-size: 50px; margin-top: 30px; }
        .menu-grid { display: grid; gap: 15px; max-width: 400px; margin: 20px auto; padding: 10px; }
        .menu-btn { 
            padding: 20px; font-size: 20px; font-weight: bold; border: none; border-radius: 20px; 
            background: white; border-bottom: 5px solid #FFCDD2; cursor: pointer; color: #FF5252; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .menu-btn:active { transform: translateY(2px); border-bottom-width: 2px; }
        .list-btn { background: #FFAB91; color: white; border-bottom-color: #D84315; margin-top: 10px; }

        /* „É¢„Éº„ÉâÈÅ∏Êäû„Éù„ÉÉ„Éó„Ç¢„ÉÉ„ÉóÈ¢® */
        #mode-selection { background: rgba(255,255,255,0.9); border-radius: 25px; padding: 20px; border: 3px solid #FF5252; margin-top: 20px; display: none; }

        /* „ÇØ„Ç§„Ç∫„Ç´„Éº„Éâ */
        .card { 
            background: white; border-radius: 30px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            max-width: 500px; margin: 10px auto; border: 4px solid #FF5252; min-height: 380px; 
            display: flex; flex-direction: column; justify-content: center; position: relative; 
        }
        .word { font-size: 45px; font-weight: bold; color: #FF5252; margin: 10px 0; }
        .options { display: grid; gap: 10px; margin-top: 10px; }
        .opt-btn { padding: 18px; font-size: 18px; border: none; border-radius: 15px; background: #FFEBEE; border-bottom: 4px solid #FFCDD2; cursor: pointer; }
        
        .mode-selector { background: #FF5252; padding: 10px; border-radius: 15px; display: inline-block; color: white; margin-bottom: 10px; font-size: 12px; }
        select { border-radius: 5px; border: none; padding: 3px; background: white; margin: 0 5px; }
        
        .btn-back { background: #666; color: white; border: none; padding: 10px 20px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; }

        /* „É™„Çπ„Éà„Çπ„Çø„Ç§„É´ */
        .list-item { background: white; margin: 8px auto; padding: 12px; border-radius: 12px; max-width: 500px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #FFCDD2; }
        .list-ja { font-size: 20px; font-weight: bold; color: #FF5252; text-align: left; }
    </style>
</head>
<body>

    <div id="menu-page" class="page active">
        <div class="logo">üçÖ</div>
        <h1 style="color:#FF5252;">„Éà„Éû„Éà N5</h1>
        
        <div class="menu-grid" id="category-buttons">
            <button class="menu-btn" onclick="selectCategory('verb')">üçé ƒê·ªông t·ª´ (Verb)</button>
            <button class="menu-btn" onclick="selectCategory('noun')">üìò Danh t·ª´ (Noun)</button>
            
            <div id="mode-selection">
                <p id="selected-label" style="font-weight:bold; color:#FF5252;"></p>
                <div style="display:grid; gap:10px;">
                    <button class="menu-btn" style="background:#FFF3E0;" onclick="startGame('practice')">üìñ Luy·ªán t·∫≠p (All)</button>
                    <button class="menu-btn" style="background:#FFEBEE;" onclick="startGame('test')">üìù Ki·ªÉm tra (10 Qs)</button>
                    <button class="btn-back" onclick="cancelSelection()">H·ªßy (Back)</button>
                </div>
            </div>

            <button class="menu-btn list-btn" onclick="showListPage()">üìã Danh s√°ch (List)</button>
        </div>
    </div>

    <div id="quiz-page" class="page">
        <button class="btn-back" onclick="goToMenu()">‚Üê Menu</button>
        <div class="mode-selector">
            Lang: <select id="lang-select" onchange="initGame()">
                <option value="vi">Ti·∫øng Vi·ªát</option>
                <option value="id">Indonesia</option>
            </select>
            Type: <select id="teacher-switch" onchange="initGame()">
                <option value="student">Student</option>
                <option value="teacher">Teacher</option>
            </select>
        </div>

        <div class="card" id="main-card">
            <div id="quiz-content">
                <div id="progress" style="font-size:14px; color:#999">...</div>
                <div id="word" class="word">...</div>
                <div id="reading" style="color:#999; margin-bottom:15px; height:24px; font-size:20px;"></div>
                <div class="options" id="options-container"></div>
                <div id="teacher-controls" style="display:none; gap:10px; justify-content:center;">
                    <button class="opt-btn" onclick="toggleAnswer()" style="background:#333; color:white;">Answer</button>
                    <button class="opt-btn" onclick="nextQuestion()" style="background:#FF5252; color:white;">Next</button>
                </div>
                <div id="message" style="margin-top:20px; font-weight:bold; font-size:26px; height:30px; color:#FF5252;"></div>
            </div>
            <div id="result-content" style="display:none;">
                <h2 style="color:#FF5252;">K·∫øt qu·∫£</h2>
                <div id="score-display" style="font-size:60px; font-weight:bold; color:#FF5252; margin:20px 0;"></div>
                <button class="menu-btn" onclick="goToMenu()">Menu</button>
            </div>
        </div>
    </div>

    <div id="list-page" class="page">
        <button class="btn-back" onclick="goToMenu()">‚Üê Back</button>
        <h2 style="color:#FF5252;">Danh s√°ch t·ª´ v·ª±ng</h2>
        <div id="list-container"></div>
    </div>

    <script>
        const allData = [
            { q: "„ÅÇ„ÅÜ", r: "au", v: "g·∫∑p", i: "bertemu", g: 1 },
            { q: "„ÅÑ„Åè", r: "iku", v: "ƒëi", i: "pergi", g: 1 },
            { q: "„Åä„Åç„Çã", r: "okiru", v: "th·ª©c d·∫≠y", i: "bangun", g: 2 },
            { q: "„Åü„Åπ„Çã", r: "taberu", v: "ƒÉn", i: "makan", g: 2 },
            { q: "„Åè„Çã", r: "kuru", v: "ƒë·∫øn", i: "datang", g: 3 },
            { q: "„Åå„Å£„Åì„ÅÜ", r: "gakkou", v: "tr∆∞·ªùng h·ªçc", i: "sekolah", g: 0 },
            { q: "„Åõ„Çì„Åõ„ÅÑ", r: "sensei", v: "gi√°o vi√™n", i: "guru", g: 0 },
            { q: "„Å®„ÇÇ„Å†„Å°", r: "tomodachi", v: "b·∫°n b√®", i: "teman", g: 0 },
            { q: "„Åø„Åö", r: "mizu", v: "n∆∞·ªõc", i: "air", g: 0 },
            { q: "„Åä„Åã„Å≠", r: "okane", v: "ti·ªÅn", i: "uang", g: 0 }
        ];

        let currentCategory = '';
        let currentMode = '';
        let quizList = [];
        let current = 0;
        let score = 0;
        let isAnswerShowing = false;

        function speak(text) {
            const uttr = new SpeechSynthesisUtterance();
            uttr.text = text;
            uttr.lang = "ja-JP";
            window.speechSynthesis.speak(uttr);
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id + '-page').classList.add('active');
        }

        /* „É°„Éã„É•„ÉºÊìç‰Ωú */
        function selectCategory(cat) {
            currentCategory = cat;
            document.getElementById('mode-selection').style.display = 'block';
            document.getElementById('selected-label').innerText = cat === 'verb' ? "üçé ƒê·ªông t·ª´" : "üìò Danh t·ª´";
            // ‰ªñ„ÅÆ„Éú„Çø„É≥„ÇíÈö†„Åô
            document.querySelectorAll('.menu-btn:not(#mode-selection button)').forEach(b => b.style.display = 'none');
        }

        function cancelSelection() {
            document.getElementById('mode-selection').style.display = 'none';
            document.querySelectorAll('.menu-btn').forEach(b => b.style.display = 'block');
        }

        function startGame(mode) {
            currentMode = mode;
            showPage('quiz');
            initGame();
        }

        function goToMenu() {
            cancelSelection();
            showPage('menu');
        }

        /* „ÇØ„Ç§„Ç∫Âá¶ÁêÜ */
        function initGame() {
            const isTeacher = document.getElementById("teacher-switch").value === "teacher";
            document.getElementById("teacher-controls").style.display = isTeacher ? "flex" : "none";
            document.getElementById("options-container").style.display = isTeacher ? "none" : "grid";
            document.getElementById("quiz-content").style.display = "block";
            document.getElementById("result-content").style.display = "none";

            let data = (currentCategory === 'verb') ? allData.filter(d => d.g > 0) : allData.filter(d => d.g === 0);
            
            if(currentMode === 'test') {
                quizList = [...data].sort(() => Math.random() - 0.5).slice(0, 10);
            } else {
                quizList = [...data].sort(() => Math.random() - 0.5);
            }
            
            current = 0;
            score = 0;
            showQuestion();
        }

        function showQuestion() {
            const isTeacher = document.getElementById("teacher-switch").value === "teacher";
            const lang = document.getElementById("lang-select").value;
            const item = quizList[current];
            isAnswerShowing = false;

            document.getElementById("progress").innerText = (current + 1) + " / " + quizList.length;
            document.getElementById("word").innerText = item.q;
            document.getElementById("reading").innerText = isTeacher ? "" : item.r;
            document.getElementById("message").innerText = "";

            if(!isTeacher) {
                const correct = (lang === "vi") ? item.v : item.i;
                const opts = allData.map(d => (lang === "vi") ? d.v : d.i);
                let choices = [correct];
                while(choices.length < 4) {
                    let r = opts[Math.floor(Math.random() * opts.length)];
                    if(!choices.includes(r)) choices.push(r);
                }
                choices.sort(() => Math.random() - 0.5);

                const container = document.getElementById("options-container");
                container.innerHTML = "";
                choices.forEach(c => {
                    const btn = document.createElement("button");
                    btn.className = "opt-btn";
                    btn.innerText = c;
                    btn.onclick = () => {
                        if(c === correct) {
                            speak(item.q);
                            document.getElementById("message").innerText = "‚≠ï OK!";
                            score++;
                            setTimeout(nextQuestion, 800);
                        } else {
                            document.getElementById("message").innerText = "‚ùå " + correct;
                            setTimeout(nextQuestion, 1500);
                        }
                    };
                    container.appendChild(btn);
                });
            }
        }

        function toggleAnswer() {
            const lang = document.getElementById("lang-select").value;
            const item = quizList[current];
            if(!isAnswerShowing) {
                document.getElementById("message").innerText = (lang === "vi") ? item.v : item.i;
                document.getElementById("reading").innerText = item.r;
                speak(item.q);
                isAnswerShowing = true;
            } else {
                document.getElementById("message").innerText = "";
                document.getElementById("reading").innerText = "";
                isAnswerShowing = false;
            }
        }

        function nextQuestion() {
            current++;
            if(current < quizList.length) {
                showQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById("quiz-content").style.display = "none";
            document.getElementById("result-content").style.display = "block";
            const display = document.getElementById("score-display");
            if(currentMode === 'test') {
                display.innerText = Math.round((score / quizList.length) * 100) + "%";
            } else {
                display.innerText = "Finish!";
            }
        }

        /* „É™„Çπ„ÉàË°®Á§∫ */
        function showListPage() {
            showPage('list');
            const container = document.getElementById('list-container');
            container.innerHTML = "";
            const lang = document.getElementById("lang-select").value;

            allData.forEach(item => {
                const div = document.createElement('div');
                div.className = 'list-item';
                div.onclick = () => speak(item.q);
                const meaning = (lang === "vi") ? item.v : item.i;
                div.innerHTML = `<div class="list-ja">${item.q} <small style="color:#ccc">${item.r}</small><br><span style="font-size:14px; color:#666; font-weight:normal;">${meaning}</span></div><div>üîä</div>`;
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
