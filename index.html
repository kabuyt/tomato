<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="„Éà„Éû„Éà N5">
    <link rel="apple-touch-icon" href="images/icon.png">
    <link rel="icon" type="image/png" href="images/icon.png">

    <title>„Éà„Éû„Éà N5 Pro - Vocab Up</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; text-align: center; background: #FFF9E6; color: #333; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        .page { display: none; padding: 20px; min-height: 100vh; box-sizing: border-box; animation: fadeIn 0.3s; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .logo-container { margin-top: 30px; }
        .logo-img { width: 100px; height: 100px; object-fit: contain; border-radius: 20%; }
        .menu-grid { display: grid; gap: 12px; max-width: 400px; margin: 20px auto; padding: 10px; }
        .menu-btn { 
            padding: 20px; font-size: 19px; font-weight: bold; border: none; border-radius: 20px; 
            background: white; border-bottom: 5px solid #FFCDD2; cursor: pointer; color: #FF5252; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .menu-btn:active { transform: translateY(2px); border-bottom-width: 2px; }
        .list-btn { background: #FFAB91; color: white; border-bottom-color: #D84315; margin-top: 10px; }

        #mode-selection { background: white; border-radius: 25px; padding: 20px; border: 3px solid #FF5252; margin-top: 10px; display: none; }

        .card { 
            background: white; border-radius: 30px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            max-width: 500px; margin: 10px auto; border: 4px solid #FF5252; min-height: 380px; 
            display: flex; flex-direction: column; justify-content: center; position: relative; 
        }
        .word { font-size: 45px; font-weight: bold; color: #FF5252; margin: 10px 0; }
        .teacher-mode .word { font-size: 80px; }
        .options { display: grid; gap: 10px; margin-top: 10px; }
        .opt-btn { padding: 18px; font-size: 18px; border: none; border-radius: 15px; background: #FFEBEE; border-bottom: 4px solid #FFCDD2; cursor: pointer; }
        
        .mode-selector { background: #FF5252; padding: 10px; border-radius: 15px; display: inline-block; color: white; margin-bottom: 10px; font-size: 12px; }
        select { border-radius: 5px; border: none; padding: 3px; background: white; margin: 0 5px; }
        .btn-back { background: #666; color: white; border: none; padding: 10px 20px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; }

        .list-item { background: white; margin: 8px auto; padding: 12px; border-radius: 12px; max-width: 500px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #FFCDD2; }
        .list-ja { font-size: 20px; font-weight: bold; color: #FF5252; text-align: left; }
    </style>
</head>
<body>

    <div id="menu-page" class="page active">
        <div class="logo-container">
            <img src="images/icon.png" alt="üçÖ" class="logo-img" onerror="this.style.display='none'; document.getElementById('emoji-logo').style.display='block';">
            <div id="emoji-logo" style="display:none; font-size:80px;">üçÖ</div>
        </div>
        <h1 style="color:#FF5252; margin-top: 10px;">„Éà„Éû„Éà N5</h1>
        
        <div class="menu-grid" id="category-buttons">
            <button class="menu-btn" onclick="selectCategory('verb')">üçé ƒê·ªông t·ª´ (Verb)</button>
            <button class="menu-btn" onclick="selectCategory('noun')">üìò Danh t·ª´ (Noun)</button>
            <button class="menu-btn" onclick="selectCategory('adj')">‚ú® T√≠nh t·ª´ (Adj)</button>
            
            <div id="mode-selection">
                <p id="selected-label" style="font-weight:bold; color:#FF5252; margin-bottom:15px;"></p>
                <div style="display:grid; gap:10px;">
                    <button class="menu-btn" style="background:#FFF3E0;" onclick="startGame('practice')">üìñ Luy·ªán t·∫≠p (All)</button>
                    <button class="menu-btn" style="background:#FFEBEE;" onclick="startGame('test')">üìù Ki·ªÉm tra (10)</button>
                    <button class="btn-back" onclick="cancelSelection()">Quay l·∫°i</button>
                </div>
            </div>
            <button class="menu-btn list-btn" onclick="showListPage()">üìã Danh s√°ch (List)</button>
        </div>
    </div>

    <div id="quiz-page" class="page">
        <button class="btn-back" onclick="goToMenu()">‚Üê Menu</button>
        <div class="mode-selector">
            Lang: <select id="lang-select" onchange="initGame()"><option value="vi">Vi·ªát</option><option value="id">Indo</option></select>
            Type: <select id="teacher-switch" onchange="initGame()"><option value="student">Student</option><option value="teacher">Teacher</option></select>
        </div>
        <div class="card" id="main-card">
            <div id="quiz-content">
                <div id="progress" style="font-size:14px; color:#999">...</div>
                <div id="word" class="word">...</div>
                <div id="reading" style="color:#999; margin-bottom:15px; height:24px; font-size:20px;"></div>
                <div class="options" id="options-container"></div>
                <div id="teacher-controls" style="display:none; gap:10px; justify-content:center;">
                    <button class="opt-btn" onclick="toggleAnswer()" style="background:#333; color:white;">Answer</button>
                    <button class="opt-btn" onclick="nextQuestion()" style="background:#FF5252; color:white;">Next</button>
                </div>
                <div id="message" style="margin-top:20px; font-weight:bold; font-size:26px; height:30px; color:#FF5252;"></div>
            </div>
            <div id="result-content" style="display:none;">
                <h2 style="color:#FF5252;">Finish!</h2>
                <div id="score-display" style="font-size:60px; font-weight:bold; color:#FF5252; margin:20px 0;"></div>
                <button class="menu-btn" onclick="goToMenu()" style="width:100%">V·ªÅ Menu</button>
            </div>
        </div>
    </div>

    <div id="list-page" class="page">
        <button class="btn-back" onclick="goToMenu()">‚Üê Back</button>
        <h2 style="color:#FF5252;">Danh s√°ch</h2>
        <div id="list-container"></div>
    </div>

    <script>
        const allData = [
            // --- ÂãïË©û (g:1, 2, 3) ÂêàË®à45Ë™û ---
            { q: "„ÅÇ„ÅÜ", r: "au", v: "g·∫∑p", i: "bertemu", g: 1 },
            { q: "„ÅÑ„Åè", r: "iku", v: "ƒëi", i: "pergi", g: 1 },
            { q: "„Åã„Åà„Çã", r: "kaeru", v: "v·ªÅ", i: "pulang", g: 1 },
            { q: "„ÅÆ„ÇÄ", r: "nomu", v: "u·ªëng", i: "minum", g: 1 },
            { q: "„Åã„ÅÜ", r: "kau", v: "mua", i: "membeli", g: 1 },
            { q: "„Åç„Åè", r: "kiku", v: "nghe", i: "mendengar", g: 1 },
            { q: "„Åã„Åè", r: "kaku", v: "vi·∫øt", i: "menulis", g: 1 },
            { q: "„Çà„ÇÄ", r: "yomu", v: "ƒë·ªçc", i: "membaca", g: 1 },
            { q: "„ÅÑ„ÅÜ", r: "iu", v: "n√≥i", i: "berbicara", g: 1 },
            { q: "„Åæ„Å§", r: "matsu", v: "ƒë·ª£i", i: "menunggu", g: 1 },
            { q: "„Çà„Å∂", r: "yobu", v: "g·ªçi", i: "memanggil", g: 1 },
            { q: "„ÅÇ„Åù„Å∂", r: "asobu", v: "ch∆°i", i: "bermain", g: 1 },
            { q: "„ÅÑ„Åù„Åê", r: "isogu", v: "v·ªôi v√†ng", i: "terburu-buru", g: 1 },
            { q: "„Åä„Çà„Åê", r: "oyogu", v: "b∆°i", i: "berenang", g: 1 },
            { q: "„ÅØ„Å™„Åô", r: "hanasu", v: "n√≥i chuy·ªán", i: "berbicara", g: 1 },
            { q: "„Åü„Å§", r: "tatsu", v: "ƒë·ª©ng", i: "berdiri", g: 1 },
            { q: "„Åô„Çè„Çã", r: "suwaru", v: "ng·ªìi", i: "duduk", g: 1 },
            { q: "„ÅØ„ÅÑ„Çã", r: "hairu", v: "v√†o", i: "masuk", g: 1 },
            { q: "„ÅÜ„Çã", r: "uru", v: "b√°n", i: "menjual", g: 1 },
            { q: "„Å§„Åè„Çã", r: "tsukuru", v: "ch·∫ø t·∫°o/l√†m", i: "membuat", g: 1 },
            { q: "„Åó„Çã", r: "shiru", v: "bi·∫øt", i: "tahu", g: 1 },
            { q: "„Çè„Åã„Çã", r: "wakaru", v: "hi·ªÉu", i: "mengerti", g: 1 },
            { q: "„Åä„Çè„Çã", r: "owaru", v: "k·∫øt th√∫c", i: "selesai", g: 1 },
            { q: "„Åä„Åè„Çã", r: "okuru", v: "g·ª≠i", i: "mengirim", g: 1 },
            { q: "„Åã„ÅÜ", r: "kau", v: "nu√¥i (th√∫)", i: "memelihara", g: 1 },
            { q: "„ÅÜ„Åü„ÅÜ", r: "utau", v: "h√°t", i: "bernyanyi", g: 1 },
            { q: "„Åä„Åç„Çã", r: "okiru", v: "th·ª©c d·∫≠y", i: "bangun", g: 2 },
            { q: "„Å≠„Çã", r: "neru", v: "ng·ªß", i: "tidur", g: 2 },
            { q: "„Åü„Åπ„Çã", r: "taberu", v: "ƒÉn", i: "makan", g: 2 },
            { q: "„Åø„Çã", r: "miru", v: "xem/nh√¨n", i: "melihat", g: 2 },
            { q: "„ÅÇ„Åë„Çã", r: "akeru", v: "m·ªü", i: "membuka", g: 2 },
            { q: "„Åó„ÇÅ„Çã", r: "shimeru", v: "ƒë√≥ng", i: "menutup", g: 2 },
            { q: "„Åä„Åó„Åà„Çã", r: "oshieru", v: "d·∫°y", i: "mengajar", g: 2 },
            { q: "„Çè„Åô„Çå„Çã", r: "wasureru", v: "qu√™n", i: "lupa", g: 2 },
            { q: "„Åß„Çã", r: "deru", v: "ra ngo√†i", i: "keluar", g: 2 },
            { q: "„Åã„Çä„Çã", r: "kariru", v: "m∆∞·ª£n", i: "meminjam", g: 2 },
            { q: "„ÅÇ„Åí„Çã", r: "ageru", v: "cho/t·∫∑ng", i: "memberi", g: 2 },
            { q: "„Åè„Çå„Çã", r: "kureru", v: "cho (m√¨nh)", i: "memberi", g: 2 },
            { q: "„Åè„Çã", r: "kuru", v: "ƒë·∫øn", i: "datang", g: 3 },
            { q: "„Åô„Çã", r: "suru", v: "l√†m", i: "melakukan", g: 3 },
            { q: "„Åπ„Çì„Åç„Çá„ÅÜ„Åô„Çã", r: "benkyou-suru", v: "h·ªçc t·∫≠p", i: "belajar", g: 3 },
            { q: "„Åë„Å£„Åì„Çì„Åô„Çã", r: "kekkon-suru", v: "k·∫øt h√¥n", i: "menikah", g: 3 },
            { q: "„Åã„ÅÑ„ÇÇ„ÅÆ„Åô„Çã", r: "kaimono-suru", v: "mua s·∫Øm", i: "berbelanja", g: 3 },
            { q: "„Åï„Çì„ÅΩ„Åô„Çã", r: "sanpo-suru", v: "ƒëi d·∫°o", i: "jalan-jalan", g: 3 },
            { q: "„Ç≥„Éî„Éº„Åô„Çã", r: "kopi-suru", v: "copy", i: "fotokopi", g: 3 },

            // --- ÂêçË©û (g:0) ---
            { q: "„Åå„Å£„Åì„ÅÜ", r: "gakkou", v: "tr∆∞·ªùng h·ªçc", i: "sekolah", g: 0 },
            { q: "„Åõ„Çì„Åõ„ÅÑ", r: "sensei", v: "gi√°o vi√™n", i: "guru", g: 0 },
            { q: "„Å®„ÇÇ„Å†„Å°", r: "tomodachi", v: "b·∫°n b√®", i: "teman", g: 0 },
            { q: "„Åø„Åö", r: "mizu", v: "n∆∞·ªõc", i: "air", g: 0 },
            { q: "„Åî„ÅØ„Çì", r: "gohan", v: "c∆°m", i: "nasi", g: 0 },
            { q: "„Åª„Çì", r: "hon", v: "s√°ch", i: "buku", g: 0 },
            { q: "„Åè„Çã„Åæ", r: "kuruma", v: "xe h∆°i", i: "mobil", g: 0 },

            // --- ÂΩ¢ÂÆπË©û (g:4) ---
            { q: "„Åü„Åã„ÅÑ", r: "takai", v: "cao/ƒë·∫Øt", i: "tinggi/mahal", g: 4 },
            { q: "„ÇÑ„Åô„ÅÑ", r: "yasui", v: "r·∫ª", i: "murah", g: 4 },
            { q: "„Åä„ÅÑ„Åó„ÅÑ", r: "oishii", v: "ngon", i: "enak", g: 4 },
            { q: "„ÅÇ„Å§„ÅÑ", r: "atsui", v: "n√≥ng", i: "panas", g: 4 },
            { q: "„Åï„ÇÄ„ÅÑ", r: "samui", v: "l·∫°nh", i: "dingin", g: 4 },
            { q: "„ÅÑ„ÅÑ", r: "ii", v: "t·ªët", i: "baik", g: 4 },
            { q: "„Åä„Åä„Åç„ÅÑ", r: "ookii", v: "l·ªõn", i: "besar", g: 4 },
            { q: "„Å°„ÅÑ„Åï„ÅÑ", r: "chiisai", v: "nh·ªè", i: "kecil", g: 4 }
        ];

        let currentCategory = '';
        let currentMode = '';
        let quizList = [];
        let current = 0;
        let score = 0;
        let isAnswerShowing = false;

        function speak(text) {
            const uttr = new SpeechSynthesisUtterance();
            uttr.text = text;
            uttr.lang = "ja-JP";
            window.speechSynthesis.speak(uttr);
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id + '-page').classList.add('active');
        }

        function selectCategory(cat) {
            currentCategory = cat;
            document.getElementById('mode-selection').style.display = 'block';
            const labels = {verb: "üçé ƒê·ªông t·ª´", noun: "üìò Danh t·ª´", adj: "‚ú® T√≠nh t·ª´"};
            document.getElementById('selected-label').innerText = labels[cat];
            document.querySelectorAll('.menu-btn:not(#mode-selection button)').forEach(b => b.style.display = 'none');
        }

        function cancelSelection() {
            document.getElementById('mode-selection').style.display = 'none';
            document.querySelectorAll('.menu-btn').forEach(b => b.style.display = 'flex');
        }

        function startGame(mode) {
            currentMode = mode;
            showPage('quiz');
            initGame();
        }

        function goToMenu() {
            cancelSelection();
            showPage('menu');
        }

        function initGame() {
            const isTeacher = document.getElementById("teacher-switch").value === "teacher";
            document.getElementById("main-card").className = isTeacher ? "card teacher-mode" : "card";
            document.getElementById("teacher-controls").style.display = isTeacher ? "flex" : "none";
            document.getElementById("options-container").style.display = isTeacher ? "none" : "grid";
            document.getElementById("quiz-content").style.display = "block";
            document.getElementById("result-content").style.display = "none";
            document.getElementById("message").innerText = "";

            let data;
            // ‰øÆÊ≠£Ôºög„Åå1,2,3„ÅÆ„ÇÇ„ÅÆ„Çí„Åô„Åπ„Å¶ÂãïË©û„Å®„Åó„Å¶ÊäΩÂá∫
            if(currentCategory === 'verb') data = allData.filter(d => d.g >= 1 && d.g <= 3);
            else if(currentCategory === 'noun') data = allData.filter(d => d.g === 0);
            else data = allData.filter(d => d.g === 4);
            
            quizList = [...data].sort(() => Math.random() - 0.5);
            if(currentMode === 'test') quizList = quizList.slice(0, 10);
            
            current = 0;
            score = 0;
            showQuestion();
        }

        function showQuestion() {
            const isTeacher = document.getElementById("teacher-switch").value === "teacher";
            const lang = document.getElementById("lang-select").value;
            const item = quizList[current];
            isAnswerShowing = false;

            document.getElementById("progress").innerText = (current + 1) + " / " + quizList.length;
            document.getElementById("word").innerText = item.q;
            document.getElementById("reading").innerText = isTeacher ? "" : item.r;
            document.getElementById("message").innerText = "";

            if(!isTeacher) {
                const correct = (lang === "vi") ? item.v : item.i;
                const allOpts = allData.map(d => (lang === "vi") ? d.v : d.i);
                let choices = [correct];
                while(choices.length < 4) {
                    let r = allOpts[Math.floor(Math.random() * allOpts.length)];
                    if(!choices.includes(r)) choices.push(r);
                }
                choices.sort(() => Math.random() - 0.5);

                const container = document.getElementById("options-container");
                container.innerHTML = "";
                choices.forEach(c => {
                    const btn = document.createElement("button");
                    btn.className = "opt-btn";
                    btn.innerText = c;
                    btn.onclick = () => {
                        if(c === correct) {
                            speak(item.q);
                            document.getElementById("message").innerText = "‚≠ï OK!";
                            score++;
                            setTimeout(nextQuestion, 800);
                        } else {
                            document.getElementById("message").innerText = "‚ùå " + correct;
                            setTimeout(nextQuestion, 1500);
                        }
                    };
                    container.appendChild(btn);
                });
            }
        }

        function toggleAnswer() {
            const lang = document.getElementById("lang-select").value;
            const item = quizList[current];
            if(!isAnswerShowing) {
                document.getElementById("message").innerText = (lang === "vi") ? item.v : item.i;
                document.getElementById("reading").innerText = item.r;
                speak(item.q);
                isAnswerShowing = true;
            } else {
                document.getElementById("message").innerText = "";
                document.getElementById("reading").innerText = "";
                isAnswerShowing = false;
            }
        }

        function nextQuestion() {
            current++;
            if(current < quizList.length) showQuestion();
            else showResult();
        }

        function showResult() {
            document.getElementById("quiz-content").style.display = "none";
            document.getElementById("result-content").style.display = "block";
            const scoreArea = document.getElementById("score-display");
            scoreArea.innerText = currentMode === 'test' ? Math.round((score/quizList.length)*100) + "%" : "Finish!";
        }

        function showListPage() {
            showPage('list');
            const container = document.getElementById('list-container');
            container.innerHTML = "";
            const lang = document.getElementById("lang-select").value;
            allData.forEach(item => {
                const div = document.createElement('div');
                div.className = 'list-item';
                div.onclick = () => speak(item.q);
                const meaning = (lang === "vi") ? item.v : item.i;
                div.innerHTML = `<div class="list-ja">${item.q} <small style="color:#ccc">${item.r}</small><br><span style="font-size:14px; color:#666">${meaning}</span></div><div>üîä</div>`;
                container.appendChild(div);
            });
        }

        window.addEventListener("keydown", (e) => {
            if(document.getElementById("teacher-switch").value !== "teacher") return;
            if(e.code === "Space") { e.preventDefault(); toggleAnswer(); }
            if(e.code === "ArrowRight") { nextQuestion(); }
        });
    </script>
</body>
</html>
